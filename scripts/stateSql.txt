Sponsors

SELECT
        sp.sfid AS id,
        a.name,
        a.about_us__c as about_us,
        sp.year__c AS Year,
        spt.name AS Level ,
        CONCAT('/sponsor/', sp.sfid) as link,
        a.website AS website,
        a.photourl AS Logo,
        json_build_object(
          'street', a.shippingstreet,
          'city', a.shippingcity,
          'state', a.shippingstate,
          'postalcode', a.shippingpostalcode,
          'country', a.shippingcountry
        ) as shipping_address,
        json_build_object(
          'street', a.billingstreet,
          'city', a.billingcity,
          'state', a.billingstate,
          'postalcode', a.billingpostalcode,
          'country', a.billingcountry
        ) as billing_address
FROM salesforce.sponsor__c as sp
LEFT JOIN salesforce.account as a ON a.sfid = sp.account__c
LEFT JOIN salesforce.sponsor_type__c as spt ON spt.sfid = sp.type__c
WHERE sp.status__c = 'Confirmed'

Sessions

SELECT
        se.sfid as id,
        se.year__c as year,
        CONCAT('/session/', se.sfid) as link,
        se.room__c as room,
        se.date__c as date,
        se.start_time__c as start_time,
        se.end_time__c as end_time,
        se.format__c as type,
        se.track__c as track,
        se.level__c as audience_level,
        array_agg (sp.sfid) as speakers,
        se.audience__c as audience
FROM salesforce.session__c as se
INNER JOIN salesforce.speaker__c as sp on sp.session__c = se.sfid
WHERE se.status__c = 'Accepted'
GROUP BY se.sfid, se.year__c, se.room__c, se.date__c, se.start_time__c, se.end_time__c, se.format__c, se.track__c, se.level__c, se.audience__c


Demojam

SELECT
      dj.sfid as id,
      dj.year__c as year,
      dj_winner.name as winner_name,
      CONCAT('/sponsor/', dj_winner.sfid) as winner_link,
      array_agg (sp.sfid) as participants
FROM salesforce.demo_jam__c as dj
LEFT JOIN salesforce.sponsor__c as sp on sp.demo_jam_participant__c = dj.sfid
LEFT JOIN salesforce.sponsor__c as dj_winner on dj_winner.account__c = dj.winner__c
GROUP BY dj.sfid, dj.year__c, dj_winner.sfid, dj_winner.name


Speakers

SELECT
      sp.sfid as id,
      c.firstname as first_name,
      c.lastname as last_name,
      sp.title__c as title,
      CONCAT('/speaker/', sp.sfid) as link,
      c.photourl as img,
      CONCAT_WS(' ', sp.title__c, c.salutation, c.firstname, c.lastname) as img_alt,
      sp.bio__c as bio,
      se.year__c as year,
      json_build_object(
        'twitter', c.twitter__c,
        'facebook', c.facebook__c,
        'linkedin', c.linkedin__c,
        'instagram', c.instagram__c,
        'trailhead', c.trailhead__c,
        'blog', c.blog__c,
        'podcast', c.podcast__c,
        'website', c.personal_website__c
      ) as social
FROM salesforce.speaker__c as sp
LEFT JOIN salesforce.contact as c on c.sfid = sp.contact__c
INNER JOIN salesforce.session__c as se on se.sfid = sp.session__c
WHERE se.status__c = 'Accepted'
